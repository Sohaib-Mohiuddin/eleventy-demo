<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{{ title or site.name }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="{{ description or site.description }}">
  <link rel="stylesheet" href="/assets/styles.css">
</head>
<body class="min-h-screen bg-gray-50 text-gray-900 antialiased">
  <header class="mx-auto max-w-4xl px-6 py-10">
    <nav class="flex items-center justify-between">
      <a href="/" class="text-xl font-semibold">{{ site.name }}</a>
      <div class="space-x-4">
        <a href="/" class="hover:underline">Home</a>
        <a href="/posts/" class="hover:underline">Blog</a>
        <a href="/admin/" class="hover:underline">CMS</a>
      </div>
    </nav>
  </header>

  <main class="mx-auto max-w-3xl px-6 prose prose-zinc lg:prose-lg">
    {{ content | safe }}
  </main>

  <footer class="mx-auto max-w-4xl px-6 py-10">
    <p class="text-sm text-gray-500">
      Â© {% year %} {{ site.name }}.
    </p>
  </footer>

  <script>
    (function () {
      // Only run on Netlify production (optional; remove if you want it locally too)
      // if (!location.hostname.endsWith('.netlify.app') && location.hostname !== 'your.custom.domain') return;

      // If the URL hash contains Netlify Identity tokens, forward to /auth/ with the same hash.
      // Netlify Identity uses these common hash parameters:
      //   #invite_token=..., #recovery_token=..., #confirmation_token=..., #access_token=...
      var h = (location.hash || '').toLowerCase();
      if (/#(invite_token|recovery_token|confirmation_token|access_token)=/.test(h)) {
        // Preserve the entire hash so the /auth page can process it
        location.replace('/auth/' + location.hash);
      }
    })();
  </script>
</body>
</html>
